var HttPRequest = false;
function ajaxob(){HttPRequest = false;if(window.XMLHttpRequest){HttPRequest = new XMLHttpRequest();if (HttPRequest.overrideMimeType) {HttPRequest.overrideMimeType('text/html');}}else if(window.ActiveXObject){try{HttPRequest=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{HttPRequest = new ActiveXObject("Microsoft.XMLHTTP");}catch(e){}}}if(!HttPRequest){return false;}}
function opendetail(){ document.getElementById('detailproject').style.display=""; }
function closedetail(){ document.getElementById('detailproject').style.display="none"; }
function detailproject(ordid){ajaxob();var url='ajax/showdetailproject.php';var pmeters="id="+ordid;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML=HttPRequest.responseText;opendetail();}}}
function sendproject(ordid){if(confirm("ตรวจสอบงานเรียบร้อยแล้วหรือยัง ?")==true){ajaxob();var url='ajax/sendproject.php';var pmeters="id="+ordid;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){window.location="schedule.php";}}}}
function complete(ordid){if(confirm("งานที่ส่งสำเร็จเรียบร้อยหรือยัง ?")==true){ajaxob();var url='ajax/completejob.php';var pmeters="id="+ordid;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){window.location="admin.php";}}}}
function deljob(ordid){if(confirm("จะลบงานนี้จริงๆ หรือ ?")==true){ajaxob();var url='ajax/deljob.php';var pmeters="id="+ordid;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){window.location="admin.php";}}}}
function addjob(){ajaxob();var url='ajax/addjob.php';var pmeters="id=";HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML=HttPRequest.responseText;opendetail();}}}
function adddata(){if(document.getElementById('user').value!="0" && document.getElementById('project').value!="0" && document.getElementById('title').value!="" && parseInt(document.getElementById('sday').value)>0 && parseInt(document.getElementById('smount').value)>0 && parseInt(document.getElementById('syear').value)>0 && parseInt(document.getElementById('eday').value)>0 && parseInt(document.getElementById('emount').value)>0 && parseInt(document.getElementById('eyear').value)>0){ajaxob();var url='ajax/addjobdata.php';var pmeters="user="+document.getElementById('user').value+"&project=" +document.getElementById('project').value+"&title=" +document.getElementById('title').value+"&sday=" +document.getElementById('sday').value+"&smount=" +document.getElementById('smount').value+"&syear=" +document.getElementById('syear').value+"&eday=" +document.getElementById('eday').value+"&emount=" +document.getElementById('emount').value+"&eyear=" +document.getElementById('eyear').value+"&detail=" +document.getElementById('detail').value;document.getElementById('detailjob').innerHTML="<center><img src='image/loading.gif' alt='Loading...' /></center>";HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML="<center>บันทึกข้อมูลเรียบร้อยแล้ว!!</center><a class='close' onclick='closedetail()'><img src='image/close-botton.png' alt='close' /></a>";opendetail();}}}else{alert("กรอกข้อมูลไม่ครบ กรุณากรอกให้ครบ!!");}}
function deluser(user){if(confirm("จะลบงานนี้จริงๆ หรือ ?")==true){ajaxob();var url = 'ajax/deluser.php';var pmeters = "user=" + user;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange = function(){if(HttPRequest.readyState == 4){window.location="manageuser.php";}}}}
function openaddproject(){window.open("addproject.php","เพิ่ม Project ใหม่","width=480,height=240, scrollbars=no");}
function showproject(id){ajaxob();var url='ajax/showdetailprolist.php';var pmeters="id="+id;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML=HttPRequest.responseText;opendetail();}}}
function updatejob(id){ajaxob();var url='ajax/updatejob.php';var pmeters="id="+id+"&status=1";HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML=HttPRequest.responseText;opendetail();}}}
function updatejobaction(id){if(document.getElementById('user').value!="0" && document.getElementById('project').value!="0" && document.getElementById('title').value!="" && parseInt(document.getElementById('sday').value)>0 && parseInt(document.getElementById('smount').value)>0 && parseInt(document.getElementById('syear').value)>0 && parseInt(document.getElementById('eday').value)>0 && parseInt(document.getElementById('emount').value)>0 && parseInt(document.getElementById('eyear').value)>0){ajaxob();var url='ajax/updatejob.php';var pmeters="id="+id+"&status=2&user="+document.getElementById('user').value+"&project=" +document.getElementById('project').value+"&title=" +document.getElementById('title').value+"&sday=" +document.getElementById('sday').value+"&smount=" +document.getElementById('smount').value+"&syear=" +document.getElementById('syear').value+"&eday=" +document.getElementById('eday').value+"&emount=" +document.getElementById('emount').value+"&eyear=" +document.getElementById('eyear').value+"&detail=" +document.getElementById('detail').value;document.getElementById('detailjob').innerHTML="<center><img src='image/loading.gif' alt='Loading...' /></center>";HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML=HttPRequest.responseText;opendetail();}}}}
function openlistproject(start,page){ajaxob();var url='ajax/showlistproject.php';var pmeters="start="+start+"&page="+page;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){document.getElementById('detailjob').innerHTML=HttPRequest.responseText;opendetail();}}}
function openupproject(proid){window.open("addproject.php?mode=update&id="+proid,"เพิ่ม Project ใหม่","width=480,height=240, scrollbars=no");}
function delproject(prjid){if(confirm("จะลบ Project นี้จริงๆ หรือ ?")==true){ajaxob();var url='ajax/delproject.php';var pmeters="id="+prjid;HttPRequest.open('POST',url,true);HttPRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=tis-620");HttPRequest.setRequestHeader("Content-length", pmeters.length);HttPRequest.setRequestHeader("Connection", "close");HttPRequest.send(pmeters);HttPRequest.onreadystatechange=function(){if(HttPRequest.readyState==4){openlistproject();}}}}